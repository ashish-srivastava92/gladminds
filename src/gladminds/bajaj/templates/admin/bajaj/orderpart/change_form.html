


{% load i18n admin_static admin_list admin_urls suit_list suit_tags %}


{% block style %}


<!-- <script type="text/javascript" src="{% url 'admin:jsi18n' %}"></script> -->
<!-- <script src="/static/js/1.10.3_jquery-ui.js" type="text/javascript"></script> -->

    <script src="http://code.jquery.com/jquery-2.1.4.min.js"></script>
  	<link rel="stylesheet" type="text/css" href="http://getbootstrap.com/2.3.2/assets/css/bootstrap.css" media="all"/>
  	<script src="http://getbootstrap.com/2.3.2/assets/js/bootstrap.min.js"></script>
	<script src="/static/js/bootbox.min.js"></script>

  <!-- <link rel="stylesheet" type="text/css" href="/static/suit/css/suit.css" media="all"> -->
  <link rel="stylesheet" href="http://code.jquery.com/ui/1.10.3/themes/smoothness/jquery-ui.css" />

<style>
	.table-data {
		position : absolute;
	}
</style>
 {% endblock  %}
  
 {% block body %}
<p><h3>DSR Orders</h3></p>
<p>Retailer : {{retailer_name}}</p>
 <form action="{% url 'save_order_history' %}" method="POST" enctyype="multipart/form-data">
	<table class="table table-striped table-bordered table-responsive	" >
        <thead>
        	{{order_status}}
				<tr>
					 <th class="text-center">Order ID</th>
					<th class="text-center">DSR Name</th>
				       <th class="text-center">Total Value</th>
				    <th class="text-center">Ordered Date</th>
				          	{% if order_status == "open" %}
				   
				    <th class="text-center">Actions</th>
				    {% endif %}
				</tr>
				
			</thead>
			
			
        <tbody>
        	{% for each in order_display %}
        	<tr>   
        		<td class="text-center"><a href="{% url 'get_parts' each.order_id order_status  %}">{{each.order_id}}</a></td>
        		<!-- <td class="text-center">{{each.retailer_name}}</td> -->
        		<td class="text-center">{{each.dsr_name}}</td>
        		
        		<td class="text-center">{{each.total_value}}</td>        		
        		<td class="text-center">{{each.order_date}}</td>
        	{% if order_status == "open" %}
        		 
     <td class="text-center"><a  class='btn btn-success' onclick='confirmAccept(this)' data-url="{% url 'accept_order' each.ret_id  each.order_id 'accept'  %}" ordID="{{each.order_id}}" href="javascript:void(0)">Accept</a>
     	&nbsp;
		<a  class='btn btn-warning' data-toggle='modal' onclick='confirmCancel(this)' data-url="{% url 'accept_order' each.ret_id   each.order_id 'cancel' %}" ordID="{{each.order_id}}" href="javascript:void(0)">Cancel</a>
			{% endif  %}
					</tbody>
			
					</tbody></td>
        	</tr>
        	   		{% endfor %}
	
			
					</tbody>
				
		
					<input type="hidden" id="order_id"  name="order_id" value='{{order_id}}' >
						<input type="hidden" id="orders_length" value='{{order_status}}' name="orders_length"  >
		</table>
		
 </form>
 <script>

	$(document).ready(function() {
	
		$('.chk-box').change(function(e)	{
			if( $(this).is(":checked") ) {
					$(e.target).parents('tr').find('input.delivered-stock').attr('disabled', false).focus();
					$(e.target).parents('tr').find('input.datepick').attr('disabled', false);
					$(e.target).parents('tr>td').append("<input type='hidden' name='part_number' class='hiddentxt' value='"+$(this).attr("rel")+"'>")
			}
			else  {
					$(e.target).parents('tr').find('input.delivered-stock').attr('disabled', true);
					$(e.target).parents('tr').find('input.datepick').attr('disabled', true);
					$(e.target).parents('tr>td').find(".hiddentxt").remove();
			}
		});	

	});

	function confirmCancel(obj){
		bootbox.confirm("Are you sure you want to Cancel OrderID: "+$(obj).attr("ordID"), function(result) {
			if (result)
		  		location.href = $(obj).attr("data-url")
		}); 
	}
	function confirmAccept(obj){
		bootbox.confirm("Are you sure you want to accept OrderID: "+$(obj).attr("ordID"), function(result) {
			if (result)
		  		location.href = $(obj).attr("data-url")
		}); 
	}
	
	function loadOrderDetails(url, partNum, partDesc){
		$("#part_numberHead").html(partNum);
		$("#part_desc").html(partDesc)
		$("#loadParts").attr("src",url);
	}
 </script>
 <!-- Modal -->
<div class="modal hide" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>

        <p class="modal-title"><strong>Order ID:</strong> <span>{{original.id}}</span><br/>       
        <strong>Part Number:</strong> <span id="part_numberHead"></span><br/>
        <strong>Part Description:</strong> <span id="part_desc"></span></span></p>
        
      </div>
      <div class="modal-body">
          <iframe src="" width="100%" id="loadParts" height="380" name= "part_details" frameborder="0" allowtransparency="true"></iframe>  
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
      </div>
    </div>
    <!-- /.modal-content -->
  </div>
  <!-- /.modal-dialog -->
</div>
<!-- /.modal -->
{% endblock body %}
